# Статическая маршрутизация
## InterVlan Routing
В нашем примере на данный момент все VLAN-сети не "видят" друг друга. Чтобы это исправить, нужно настроить маршрутизатор для этого.

Все интерфейсы маршрутизатора *по-умолчанию выключены*. Их необходимо включать командой
```
(config-if)# no shutdown
```

## Sub-interfaces
У маршрутизатора кроме настоящих, физических интерфейсов, можно создать т.н. саб-интерфейсы. Их обычно применяют при работе с vlan.

### Создание
```
msk-arbat-gw1(config)#interface fa0/0.2
msk-arbat-gw1(config-if)#description Management
```

После точки указывается уникальный идентификатор -- он необязательно должен был равен номеру vlan, но лучше чтобы всегда он был ему равен.

### Задание номера vlan
```
msk-arbat-gw1(config-if)#encapsulation dot1Q 2
```

Где `2` -- номер vlan

### Задание IP-адреса, который будет указываться как default gateway
```
msk-arbat-gw1(config-if)#ip address 172.16.1.1 255.255.255.0
```

## Коротко о работе в сети
Как только компьютер хочет отправить данные по какому-либо IP в его сети (предположим, что компьютер еще ничего не отправлял), он делает ARP запрос: по всему широковещательному домену отправляется кадр с MAC-адресом получателя FF:FF:FF:FF:FF:FF и необходимым IP.

Коммутатор пересылает этот кадр всем внутри шир. домена. Получившие этот кадр компьютера сравнивают IP адреса и, если это тот самый IP, который мы искали, то он отправляет ответ.

Коммутатор передает ответ начальному компьютеру и тот вносит в ARP-кеш соответствие IP-адресу MAC-адрес. Теперь компьютер может отправлять данные по нужному IP.

## ARP-кеш
Чтобы посмотреть кеш компьютера:
```
arp -a
```

Чтобы посмотреть кеш IOS:
```
#show arp
```

## Суммирование сетей
todo

## Просмотр текущей таблицы маршрутизации
```
#show ip route
```

## Ссылки для чтения
* [NTP](http://ru.wikipedia.org/wiki/Ntp)
* [Еще раз про IP-адреса, маски подсетей и вообще](https://habr.com/post/129664/)